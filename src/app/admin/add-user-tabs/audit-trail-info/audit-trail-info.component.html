<div class="audit-trail-container">
  <style>
    ::ng-deep .mat-tooltip {
      white-space: pre-wrap !important;
      max-width: 400px !important;
      max-height: 300px !important;
      overflow-y: auto !important;
      overflow-wrap: break-word !important;
      font-size: 12px !important;
      color: #000 !important;
      background-color: #fff !important;
    }
  </style>

  <div class="col-sm-12 ">
    <h3 class="font-bold">AUDIT TRAIL</h3>
    <p>Last Login: {{lastLoginDate }}</p>
  </div>


  <div class="mat-elevation-z8">
    <table mat-table [dataSource]="dataSource" matSort>
      <!-- Timestamp Column -->
      <ng-container matColumnDef="changedOn">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Timestamp </th>
        <td mat-cell *matCellDef="let row"> {{row.changedOn | date:'MM/dd/yyyy hh:mm a'}} </td>
      </ng-container>

      <!-- User Column -->
      <ng-container matColumnDef="updatedBy">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> User </th>
        <td mat-cell *matCellDef="let row"> {{row.updatedBy}} </td>
      </ng-container>

      <!-- Screen Column -->
      <ng-container matColumnDef="tabName">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Screen </th>
        <td mat-cell *matCellDef="let row"> {{row.tabName}} </td>
      </ng-container>

      <!-- Field Column -->
      <ng-container matColumnDef="propertyName">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Field </th>
        <td mat-cell *matCellDef="let row"> {{row.propertyName}} </td>
      </ng-container>

      <!-- Previous Value Column -->
      <ng-container matColumnDef="oldValue">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Previous Value </th>
        <td mat-cell *matCellDef="let row">
          <span [matTooltip]="row.oldValue || ''" [matTooltipDisabled]="!row.oldValue || row.oldValue.length <= 80">
            {{ row.oldValue?.length > 80 ? (row.oldValue | slice:0:80) + '...' : row.oldValue }}
          </span>
        </td>
      </ng-container>

      <!-- New Value Column -->
      <ng-container matColumnDef="newValue">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> New Value </th>
        <td mat-cell *matCellDef="let row">
          <span [matTooltip]="row.newValue || ''" [matTooltipDisabled]="!row.newValue || row.newValue.length <= 80">
            {{ row.newValue?.length > 80 ? (row.newValue | slice:0:80) + '...' : row.newValue }}
          </span>
        </td>
      </ng-container>
   

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

      <!-- Row shown when there is no matching data. -->
      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" colspan="6">No data available</td>
      </tr>
    </table>

    <mat-paginator #paginator [length]="totalCount" [pageSize]="pageSize" [pageSizeOptions]="[100, 150, 200, 250, 300]" showFirstLastButtons aria-label="Select page of surveys">
    </mat-paginator>
  </div>
</div>
