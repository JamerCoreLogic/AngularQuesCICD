<div class="container-fluid-lg bg-opprtunity py-3">
    <div class="row">
        <div class="col-sm-12">
            <div class="row align-items-center">
                <div class="col-lg-12 col-md-12 col-sm-12 col-12 align-items-center">
                    <div class="row">
                        <div class="row dashboard_heading col-sm-6 col-md-4 col-lg-4">
                            <h3>Custom Report</h3>
                        </div>
                    </div>
                    <div class="whtCon">
                        <div class="row ">
                            <div class="resource_head col-sm-6 col-md-3 col-lg-1 my-3 ">
                                <h3>Columns :</h3>
                            </div>
                            <div class="col-sm-6 col-md-4 col-lg-2 my-3 " id="custom_formselect">
                                <mat-form-field appearance="outline">
                                    <mat-select [formControl]="toppings" multiple placeholder="Select" >
                                        <mat-option *ngFor="let cols of displayedFieldsList"
                                            [value]="cols.keyName">{{cols.keyValue}}</mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="resource_head col-sm-6 col-md-3 col-lg-1 my-3 search-by">
                                <h3>Search By :</h3>
                            </div>
                            <div class="col-sm-6 col-md-4 col-lg-2 my-3 " id="filter_bg">
                                <label class="visually-hidden select-box fs" for="inlineFormSelectPref"></label>
                                <select class="select" (change)="filterBasedOn($event)">
                                    <option value="All" selected>All</option>
                                    <option *ngFor="let item of FiledsList" [value]="item.keyName">{{item.keyValue}}
                                    </option>

                                </select>
                            </div>
                            <div class="col-sm-12 col-md-4 col-lg-2 my-3 item" style="position:relative">
                                <mat-form-field appearance="outline">

                                    <input matInput [(ngModel)]="searchString" (keypress.enter)="applyFilter()"
                                        placeholder="Search" #input class="w-100">
                                </mat-form-field>


                            </div>
                            <div class="col-lg-1 col-sm-12 col-md-12 col-12 my-3">
                                <div class="add_button text-end">
                                    <button mat-raised-button class="bg-greendark text-light"
                                        (click)="applyFilter()"><mat-icon>search</mat-icon> Search</button>
                                </div>
                            </div>
                            <div class="col-lg1 col-sm-12 col-md-12 col-12 my-3">
                                <button mat-icon-button [matMenuTriggerFor]="menu" #menuTrigger="matMenuTrigger"
                                    (click)="menuTrigger.openMenu(); $event.stopPropagation()"
                                    aria-label="Example icon-button with a menu">
                                    <mat-icon class="filter" [ngClass]="{'applied-filter': isFilterApplied}"
                                        #tooltip="matTooltip" matTooltipClass="bg-light text-dark border border-info"
                                        matTooltip="Advance Filters" matTooltipPosition="above">filter_list</mat-icon>
                                </button>
                                <mat-menu #menu="matMenu" xPosition="before" class="custom-mat-menu">
                                    <div>
                                        <div class="clse">
                                            <button mat-icon-button class="float-end close-icon-inmenue"
                                                (click)="menuTrigger.closeMenu(); $event.stopPropagation()">
                                                <mat-icon>remove</mat-icon>
                                            </button>
                                        </div>

                                        <app-filters *ngIf="FiledsList && FiledsList.length > 0 && originalUserData$"
                                            [filteredData$]="originalUserData$" [filterFieldsData]="FiledsList"
                                            (operatorValue)="getOperator($event)"
                                            (data)="updateFilterData($event)"
                                            (companyNamevalue)="getCompanyName($event)"
                                            (surveyNameValue)="getSurveyName($event)"
                                            (surveyTitleValue)="getSurveyTitle($event)"
                                            (dateForFilter)="getDateforFilter($event)"
                                            (resetSearchvalue)="resetSearchvalueinReports($event)">
                                        </app-filters>
                                    </div>
                                </mat-menu>
                            </div>
                            <div class="col-lg-2 col-sm-12 col-md-12 col-12 my-3">
                                <button mat-icon-button (click)="downloadExcel()">
                                    <mat-icon class="filter" [ngClass]="{'applied-filter': isFilterApplied}"
                                        #tooltip="matTooltip" matTooltipClass="bg-light text-dark border border-info"
                                        matTooltip="Download" matTooltipPosition="above">cloud_download</mat-icon>
                                </button> &nbsp;
                                <button mat-raised-button class="bg-greendark text-light"
                                        (click)="navigateToCustomView()"><mat-icon>view_list</mat-icon>Custom Views</button>
                                
                            </div>
                        </div>
                    </div>
                </div>

            </div>

        </div>
        <!-- table section -->
        <div class="col-sm-12 table_pddng">
            <mat-card>
                <mat-card-content class="example-container" id="table_hght_Report">
                    <div class=" dashboard_sticky_container table-wrapper_scroll">   
                        <table mat-table [dataSource]="dataSource" [cdkDropListData]="dataSource" #table
                            class="mat-elevation-z8" cdkDropList cdkDropListOrientation="horizontal"
                            (cdkDropListDropped)="drop($event)" matSort (matSortChange)="sortData($event)">

                            <ng-container *ngFor="let field of displayedColumns">
                                <ng-container matColumnDef="{{ field }}">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header cdkDrag>{{ getHeaderDisplay(field) }}</th>
                                    <td mat-cell *matCellDef="let element">
                                        <span matTooltip="{{ element[field] }}" matTooltipClass="custom-tooltip-reports">
                                            {{ element[field]?.length > 80 ? (element[field] | slice:0:80) + '...' : element[field] }}
                                        </span>
                                    </td>
                                </ng-container>
                            </ng-container>
                            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                            <!-- Row shown when there is no matching data. -->
                            <tr class="mat-row" *matNoDataRow>
                                <td class="mat-cell" colspan="4">No data matching the filter</td>
                            </tr>
                        </table>
                    </div>
                </mat-card-content>
                <mat-paginator #paginator stickyEnd [pageSize]="pageSize" [pageSizeOptions]="[5, 10, 25, 100]"
                    [length]="totalData" aria-label="Select page of users"></mat-paginator>
            </mat-card>
        </div>
    </div>
</div>